language: python

python:
  - 3.7

git:
  submodules: false

before_install:
  # cannot use SSH to fetch submodule
  - sed -i 's#git@github.com:#https://github.com/#' .gitmodules
  - git submodule update --init --recursive

install:
  - pip install -r requirements.txt

scripts:
  - qgis-plugin-ci -v

jobs:
  include:
    - stage: push-translation
      if: branch = master AND repo = QGEP/qgis_wincan2qgep
      script: qgis-plugin-ci push-translation ${TX_TOKEN}

    - stage: deploy
      if: tag IS present AND repo = QGEP/qgis_wincan2qgep
      script:
        - >
          qgis-plugin-ci release ${TRAVIS_TAG}
          --transifex-token ${TX_TOKEN}
          --github-token ${GH_TOKEN}
          --osgeo-username ${OSGEO_USERNAME}
          --osgeo-password ${OSGEO_PASSWORD}

env:
  global:
    # OSGEO_USERNAME
    - secure: "fvptHzANZyz5/RoeFbuj2EymCWGEQBniDb+auTT6S+7DndVDkIAnYp3gTAEl9TbjD6fmKvdOiAKqezvuiedNY/FJMFN9pxKBWg1dKFzuDfbWJpF8+beTF93uQqXSKbeAJxRYz/FrJ0IgNKg16TJx/f42NTCoR22mr/xm9bD2HQbYCpWwnHwtRhDNA/JwSqbgpzx1XfFPEXFwn5EEQGfc49amm3gCVg4XMw06y/G0jGu/yG52tqQTDgPNN916UZo4PkJcDd+n/FQQ0DKx02RcTE59fuU5IljdPnYu/xgzGG9QfqTZ6x0mKefFYJ9JFnWDNRcxoSmiCpzXr2coPbasVer4Vaqk+9BGNuMOOqiQoEqqH7iknDmdx+pV16qa4CzO7poDcTAofufAqm0cDjNtzf8L6JtvJYgRSYP9lqL/rTzo/NqAgxmpJvMNqO8t5JBQT8GVAuniRJzlXHeZeYSgMWkQFKqojJd6Pgd2yxRY50J8S2JOZU+2xC/+Suv3RnuM5LDaMCDqNx7YAfJEumdQPVyXqbl8mOEQXbUGvCbrhogZ87RjoKmiLW4GoAvWdcphmIwUpxXMx4DV1c2UO91FXOsztbCLjv14ou/dB5sGI1VEepPY42CGlbwRRfVPcH6PASxjerhCCNRoL82YJ3PoUoRZmmk+1DROmKnXPLIaCE8="
    # OSGEO_PASSWORD
    - secure: "ZFVVZVXWCtQJYzSBMFoJbgkiBMmlk2wGkfSUUZhEjGlaZExyl7aVvY35rfNyI1iWE2c0uILYxhkB1UrEeKmKr2E37nivahBqmqZd1ZOphmnBd+scy/onaz1tReJi60cHZUG3GgCDCp7P7z63We5z2mwWKVAXSruPAzEtbZd5efbZM4w2Abf+EbuhR+dD3zZpUvbikn5ujG8KByd7lyncMxc8RylAoPuyK0Q4NooaODHqPoGFq1sgJBWgxCiPgPu19tsqHbMDCcMniZ9SzYO3cAfv0DE4bCwsL9L3UNBy9lSYfuQaz1buoLVhCOImA41ovuNgMd0nd5TAyZnwAqi7vgH+yxQ1is5p2/ZEzJ58GocZegEnYzZYeLUBdOOuyBKvZl/nOBo4nFULzrjRogCt0j0RXS3HLcE6LWQrw8yXKn5pMZCZqVK/SLHpkYFMaUa6Fj1s8VGRPHzVMesfVb8QBKVYdFNMi/T3oM++qC7QDWeRuOh9hzQpqG8c+IZlePQMibEgAkffLgrNGMjsB5ECjxv6Kb5HSjpsTEhVTfI7iQi1pXqqnVgOm51MXnK32Hj2yDR+WIk+1P5ayfDI4HuMVHtpU4WXfBgMP4kAy5vE0GSszWS+H8iYsCgGm/QOSA4rRtPp+ilGQtGiuxQjGFR22U82MA24mfDdadfWMxEdDk4="
    # TX_TOKEN
    - secure: "Db1GrKLhb2SFxmU8/F550LXw09UsdTgrOuCE85MviqEmvnqWMhXbfWd/x3FA9ixrxSKcniMeAF2TC/f6diqixf3uZF0A5htyMErTCowqhJWTdwUneHOt+5As7UE9xgQ7oE/4OJBrzzfWHVfyjnwAAWxTlXuCZLcvg+1u1e6iw3O7p3Oh4iBR3AcCrLD+j/Bfl46cmii4l+AaqtEu7pAwh7KLU/9BYLafNQNYwPTQYJvLusxAkwxaUvoatCfYKM/wEJ/Cnn6/ZnoKaM3FcfqaHn4NY5xltDu2xgCDn+Dq7utTeMsn7AytkUDCvqcKWtsxomVEsiPrdj4ZRb1TpeCqBReLn4LubeTWDU2dwhdMR5cR9VpYK1vECeSgLj52ziatMjfaZ5sRqgx9KJNHCB0SoXYWy8l/+ncvsexCWYJcaSJqmdbfJTmXKiUOVfMwPJPPiQRnLrd6kECETzETkoZgYhUdocESXeCU1sJXtuXtsh5RPjsJe/V3ZhqvedBM3mYQBD2BwB3TT7LK+5q+JYOSg1lQJ8kJHWV8KIdgTP1Zrqt6ZJPXx+FVWBONEc+/iS6rQMVydxpl5vT8tij1wiFhIp3ol4ZnkO2rPccr6vkQoPvrn+S4YRIvbMqliB0bFW8aUwBRe/Wg6DF5ADdl1DnuZxQ74mgperGVC5K+qAYUHjE="
    # GH_TOKEN
    - secure: "pVjzQPGLrReHhr7vQCJ5GqCPIw75KMEq1kjcVFaFzTI4LeIx9kNt6WXT419T3sEUJbpbpLsUtWbwfHPUcI33KQXuVTk+hfCf+UcFIdGCafVaqSIrbFAWGGK+ZhJQ27AqkoK3vhmUMj0Wx2mp9RiVOBCi5DGm353z+Rhrr3Cm9w4qaauvVzUeEJ+F7q2BLBMJRMHHWpeDg+IWh6EWmj3VwQ9OfQ5RlvUlNosQJsKZJ+sxQWM+Fd8T7vEEa0U7RpC5/I4sulh+YHQ20PMkJpXm5KpEU1DEO24m6s9QcF8KOxitE5JRCX2asaIxIZwzTHw1LeXqi6S3KWz28BCc/8i3soY/6S9+CwYy+XPQMPYWZ93XmERsD/pTLTUmUrb3dE8NJeYTdo9dbEzDE+HPRPGIuuZmBZCWUhpPDGn4SddJAZi+T8j6Q0tLYXXyRzAUaqSLD4huGOwCavyND1R9MmB/xav1MI55+fHF3OzqPApkGTuHRr3bx1TTO3HR42mL1V5tJ1ukPUKX+mKJo9c/Ef8Qbide10lnzJQ06ygxun5LFxUHTNdk5w+g9XaZ3sTQDXgau+G8dbGShX2VDGcUOL4hEOXwgmkngQnQf7X+mTvdZltXQ0IxjZP+Y4Yy1lka6O+/DYEX3gaORdDQs+Zvo+Axrt8T2GG1cVG0tKTxiqmNNdk="
